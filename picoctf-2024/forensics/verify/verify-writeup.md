# PicoCTF 2024 Forensics Writeup: Verify

## Downloading the Files
Even though downloading the file isn't really necessary but as we want to be unbound by a time limit or we could SSH our way in to the instance as it's also the same steps as well(other than the unzipping part). We can download the required files using `wget`:

```bash
wget https://artifacts.picoctf.net/c_rhea/22/challenge.zip
```

## Decompressing the file
We are given a zip file, let's try to unzipping it!

```bash
unzip challenge.zip
```

Well it looks like it extracted a few files which are `checksum.txt`,  `decrypt.sh`, and a directroy which is `files/`

## Objectives
The directive of the problem states that we need to find a checksum that's identical to what we have in`checksum.txt` and decrypt it, so let's first check the contents of `checksum.txt`:

```bash
cat checksum.txt
```
**Output:**
```
55b983afdd9d10718f1db3983459efc5cc3f5a66841e2651041e25dec3efd46a
```

Okay so it's a `SHA256` checksum as directed, now we just need to find any files inside `files/` that has the same `SHA256` checksum as the one we have:

```bash
sha256sum files/* | grep "55b983afdd9d10718f1db3983459efc5cc3f5a66841e2651041e25dec3efd46a"
```

As previously mentioned `sha256sum` is a command in linux that creates a SHA256 hash of a file and by directing it using `files/*` it's going to check for every file that exists in the directory and afterwards the `|` or pipe operator will direct the output of the first command to our second command which is `grep`, and as a result we get the following file:

**Output:**
```
55b983afdd9d10718f1db3983459efc5cc3f5a66841e2651041e25dec3efd46a  files/2cdcb2de
```
Nice! So our `grep` command with our checksum came with one file! So this should be the encrypted file that should store our flag!

## SSH in
Now that we know of the file that should store our flag, we just need to `ssh` into the instance!

```bash
ssh -p RPORT ctf-player@rhea.picoctf.net
```

Note that `RPORT` here stands for "Remote Port" which would be the port generated by the instance! Also be sure to type `yes` when asked for the fingerprint, and enter the password that was listed in the problem! Your terminal should look a bit like the following:

**Output:**
```
Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 6.5.0-1016-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

ctf-player@pico-chall$
```

Now lets check what files are available to us!

```bash
ls
```

**Output:**
```
checksum.txt  decrypt.sh  files
```

Okay so that's the same exact files as we had from the zip so let's just decrypt the file that contains the flag with the following command:

```bash
./decrypt.sh files/2cdcb2de
```

**Output:**
```
picoCTF{trust_but_verify_2cdcb2de}
```

That's it! that's the flag!
